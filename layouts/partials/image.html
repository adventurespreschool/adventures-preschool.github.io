{{- $src := .Src -}}
{{- $alt := .Alt | default "image" -}}
{{- $class := .Class | default "" -}}
{{- $height := .Height | default "" -}}
{{- $width := .Width | default "" -}}

<!-- DEBUG: Custom partial called, BaseURL: {{ site.BaseURL }} -->
{{- if $src -}}
  {{- if hasPrefix $src "http" -}}
    <img src="{{ $src }}" alt="{{ $alt }}" class="{{ $class }}"{{ with $height }} height="{{ . }}"{{ end }}{{ with $width }} width="{{ . }}"{{ end }}>
  {{- else -}}
    {{- if eq site.BaseURL "/" -}}
      <!-- DEBUG: Using local baseURL -->
      <img src="/{{ strings.TrimPrefix "/" $src }}" alt="{{ $alt }}" class="{{ $class }}"{{ with $height }} height="{{ . }}"{{ end }}{{ with $width }} width="{{ . }}"{{ end }}>
    {{- else -}}
      <!-- DEBUG: Using production baseURL: {{ site.BaseURL }} -->
      {{- $url := printf "%s%s" site.BaseURL (strings.TrimPrefix "/" $src) -}}
      <img src="{{ $url }}" alt="{{ $alt }}" class="{{ $class }}"{{ with $height }} height="{{ . }}"{{ end }}{{ with $width }} width="{{ . }}"{{ end }}>
    {{- end -}}
  {{- end -}}
{{- end -}}